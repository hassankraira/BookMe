<div class="gradient-glow"></div> <!-- Glow background -->

<div class="container2">
  <form class="form-container needs-validation" novalidate (ngSubmit)="register()" #signupForm="ngForm">
    <h2>Register</h2>
    <div *ngIf="successMessage" class="message success">
      {{ successMessage }}
    </div>
    
    <div *ngIf="loginError" class="message error">
      {{ loginError }}
    </div>
    <!-- Step 1 -->
    <div class="container3" *ngIf="step === 1">
      <div class="form-group">
        <input  type="text" class="form-control " name="firstName" [(ngModel)]="user.firstName" placeholder="First Name" required />
      </div>
      <div class="form-group">
        <input type="text" class="form-control" name="lastName" [(ngModel)]="user.lastName" placeholder="Last Name" required />
      </div>
      <div class="form-group d-flex">
        <input type="email" class="form-control" name="email" [(ngModel)]="user.email" placeholder="Email" required />
      </div>
      <div class="form-group d-flex">
        <input type="tel" class="form-control" name="phone" [(ngModel)]="user.phone" placeholder="Phone Number" required />
      </div>
      <button type="button" class="btn btn-primary w-100" [disabled]="otpSent" (click)="sendOTP()"  > {{ otpSent ? 'Next...' : 'Next' }}</button>

    </div>

    <div class="container3" *ngIf="step === 2">
      <p>Verification code sent to <strong>{{ user.email }}</strong></p>
    
      <div class="form-group">
        <input  type="tel"  class="form-control"  name="otp"  [(ngModel)]="enteredOTP"  placeholder="Enter OTP"  pattern="^[0-9]{6}$"  maxlength="6"  required
        />
      </div>
    
      <button type="button" class="btn btn-primary w-100" (click)="verifyOTP()">Verify OTP</button>
    
      <p *ngIf="otpVerified" class="success">✅ Verified</p>
      <p *ngIf="otpInvalid" class="error">❌ Invalid OTP</p>
    
      <button *ngIf="!resendAllowed" class="btn btn-secondary mt-2 w-100" disabled>
        Resend in {{ resendTimer }}s
      </button>
    
      <button *ngIf="resendAllowed" class="btn btn-warning mt-2 w-100 btn-primary" type="button" (click)="resendOTP()">
        Resend OTP
      </button>
    </div>
    <!-- Step 3 -->
    <div class="container3" *ngIf="step === 3">
      <div class="form-group">
        <input type="password" class="form-control" name="password" [(ngModel)]="user.password" placeholder="Password" required />
      </div>
      <div class="form-group">
        <input type="password" class="form-control" name="confirmPassword" [(ngModel)]="confirmPassword" placeholder="Rewrite Password" required />
      </div>
      <button type="submit"  class="btn btn-success w-100"   [disabled]="!otpVerified">Sign Up</button>
    </div>
    <p>Already have an account? <a routerLink="/login"> LOG IN</a></p>
  </form>
</div>